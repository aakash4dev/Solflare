"use strict";(self.webpackChunk_solflare_extension=self.webpackChunk_solflare_extension||[]).push([["libs_shared_dist_features_activity_index_js"],{"../../libs/shared/dist/features/activity/api/index.js":(e,t,s)=>{var i=s("../../../node_modules/console-browserify/index.js");Object.defineProperty(t,"__esModule",{value:!0}),t.fetchTransactions=t.fetchNewSignatures=t.fetchSignatures=void 0;const a="https://activity-api.solflare.com";async function*n(e){let t="";for(;;){const{done:s,value:i}=await e.read();if(s)break;t+=(new TextDecoder).decode(i);const a=t.split("<|EOF|>");if(1!==a.length){for(let e=0;e<a.length-1;e++){const t=JSON.parse(a[e]);yield t}t=a[a.length-1]}}}t.fetchSignatures=async function*(e,t,s=!1,o=0){if(e)try{const i=(await fetch(`${a}/v1/signatures?address=${e}&network=${t}&ignoreFailed=${+s}&limit=${o}`)).body.getReader();for await(const e of n(i))yield e}catch(e){i.log("error",e)}},t.fetchNewSignatures=async function*(e,t,s,o=!1,r=0){if(e&&s)try{const i=(await fetch(`${a}/v1/signatures/newer?address=${e}&lastSignature=${s}&network=${t}&ignoreFailed=${+o}&limit=${r}`)).body.getReader();for await(const e of n(i))yield e}catch(e){i.log("error",e)}},t.fetchTransactions=async function*(e,t,s,o,r){if(e)try{const i=(await fetch(`${a}/v1/transactions?network=${t}`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({language:s,layout:r,address:e,signatures:o})})).body.getReader();yield*n(i)}catch(e){i.log("error",e)}}},"../../libs/shared/dist/features/activity/components/Address.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s("../../../node_modules/react/jsx-runtime.js"),n=s("../../../node_modules/@mui/material/index.js"),o=i(s("../../../node_modules/@mui/styles/makeStyles/index.js")),r=(i(s("../../../node_modules/react/index.js")),s("../../../node_modules/react-i18next/dist/es/index.js")),d=s("../../../node_modules/react-redux/es/index.js"),c=s("../../libs/shared/dist/store/actions/common.js"),l=s("../../libs/shared/dist/utils/truncateMiddle.js"),u=s("../../libs/shared/dist/features/pfp/index.js"),f=s("../../libs/shared/dist/features/activity/selectors/index.js"),h=(0,o.default)((e=>({avatarWrapper:{marginRight:8},address:{whieSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer"},addressTooltip:{"&:hover":{opacity:.7}}})));t.default=function(e){const t=(0,d.useSelector)(f.knownAddressSelector),s=h(),i=(0,d.useDispatch)(),{t:o}=(0,r.useTranslation)();return(0,a.jsxs)(n.Box,{style:{display:"flex",alignItems:"center",maxWidth:170},children:[e.withAvatar&&(0,a.jsx)("div",{className:s.avatarWrapper,children:(0,a.jsx)(u.PFPAvatar,{size:"s",publicKey:e.content})}),t.hasOwnProperty(e.content)?(0,a.jsx)(n.Tooltip,{placement:"top",title:o("action_view_in_explorer"),className:s.addressTooltip,onClick:t=>{t.stopPropagation(t),i((0,c.openExplorerAccount)({account:e.content}))},children:(0,a.jsx)("span",{className:s.address,children:t[e.content]})}):(0,a.jsx)(n.Tooltip,{placement:"top",title:o("action_view_in_explorer"),className:s.addressTooltip,onClick:t=>{t.stopPropagation(t),i((0,c.openExplorerAccount)({account:e.content}))},children:(0,a.jsx)("span",{className:s.address,children:(0,l.truncateMiddle)(e.content)})})]})}},"../../libs/shared/dist/features/activity/components/Avatar.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s("../../../node_modules/react/jsx-runtime.js"),n=s("../../libs/foundation-ui/dist/index.js"),o=(i(s("../../../node_modules/react/index.js")),s("../../libs/shared/dist/utils/getResizedImageUrl.js")),r=s("../../libs/shared/dist/features/activity/components/Icon.js");t.default=function(e){return(0,a.jsx)(n.ActivityAvatar,{src:e.src?(0,o.getResizedImageUrl)(e.src,{width:100,height:100}):null,icon:(0,r.iconMap)(e.icon),shape:e.shape})}},"../../libs/shared/dist/features/activity/components/AvatarDouble.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s("../../../node_modules/react/jsx-runtime.js"),n=s("../../libs/foundation-ui/dist/index.js"),o=(i(s("../../../node_modules/react/index.js")),s("../../libs/shared/dist/utils/getResizedImageUrl.js")),r=s("../../libs/shared/dist/features/activity/components/Icon.js");t.default=function(e){return(0,a.jsx)(n.ActivityDoubleAvatar,{src1:e.src1?(0,o.getResizedImageUrl)(e.src1,{width:100,height:100}):null,icon1:(0,r.iconMap)(e.icon1),shape1:e.shape1,src2:e.src2?(0,o.getResizedImageUrl)(e.src2,{width:100,height:100}):null,icon2:(0,r.iconMap)(e.icon2),shape2:e.shape2})}},"../../libs/shared/dist/features/activity/components/Balances.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s("../../../node_modules/react/jsx-runtime.js"),n=s("../../libs/foundation-ui/dist/index.js"),o=(i(s("../../../node_modules/react/index.js")),s("../../libs/shared/dist/utils/displayPrice.js")),r=s("../../libs/shared/dist/utils/getResizedImageUrl.js");t.default=function(e){const t=e.positives?.map((t=>({...t,image:t.image?(0,r.getResizedImageUrl)(t.image,{width:100,height:100}):void 0,amount:e.format?`+${(0,o.displayPrice)({amount:t.amount,pricePerCoin:t.price,displayType:"amount"})}`:`+${t.amount}`})))??[],s=e.negatives?.map((t=>({...t,image:t.image?(0,r.getResizedImageUrl)(t.image,{width:100,height:100}):void 0,amount:e.format?(0,o.displayPrice)({amount:t.amount,pricePerCoin:t.price,displayType:"amount"}):t.amount})))??[],i="details"===e.layout?n.ActivityDetailsBalances:n.ActivityBalances;return(0,a.jsx)(i,{shorterNames:e.shorterNames,failedText:e.failedText,withImage:e.withImage,positives:t,negatives:s})}},"../../libs/shared/dist/features/activity/components/ExtLineItem.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s("../../../node_modules/react/jsx-runtime.js"),n=s("../../libs/foundation-ui/dist/index.js");i(s("../../../node_modules/react/index.js")),t.default=function(e){return(0,a.jsx)(n.ActivityListItem,{loading:e.loading,title:e.title,subtitle:e.subtitle,avatar:e.avatar,children:e.balances})}},"../../libs/shared/dist/features/activity/components/Icon.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.iconMap=void 0;const a=s("../../../node_modules/react/jsx-runtime.js"),n=s("../../../node_modules/@fortawesome/pro-light-svg-icons/index.js"),o=s("../../libs/foundation-ui/dist/index.js");function r(e){switch(e){case"faWavePulse":return n.faWavePulse;case"faArrowRight":return n.faArrowRight;case"faPiggyBank":return n.faPiggyBank;default:return n.faQuestion}}i(s("../../../node_modules/react/index.js")),t.iconMap=r,t.default=function(e){return(0,a.jsx)(o.Icon,{icon:r(e.name)})}},"../../libs/shared/dist/features/activity/components/Text.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s("../../../node_modules/react/jsx-runtime.js");i(s("../../../node_modules/react/index.js")),t.default=function(e){return(0,a.jsx)("span",{children:e.content})}},"../../libs/shared/dist/features/activity/components/WebLineItem.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s("../../../node_modules/react/jsx-runtime.js"),n=s("../../libs/foundation-ui/dist/index.js"),o=(i(s("../../../node_modules/react/index.js")),s("../../libs/shared/dist/utils/humanDate.js"));t.default=function(e){const t=e?.blockTime?1e3*e.blockTime:null,s=(0,o.humanDate)(t,!1,!1);return e.loading?(0,a.jsx)(n.LoadingActivityListItemWeb,{blockTime:e?.blockTime?s:null}):(0,a.jsx)(n.ActivityListItemWeb,{blockTime:s,event:e.event,details:e.details,children:e.balances})}},"../../libs/shared/dist/features/activity/components/index.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;const a=s("../../../node_modules/react/jsx-runtime.js"),n=(i(s("../../../node_modules/react/index.js")),i(s("../../libs/shared/dist/features/activity/components/Address.js"))),o=i(s("../../libs/shared/dist/features/activity/components/Avatar.js")),r=i(s("../../libs/shared/dist/features/activity/components/AvatarDouble.js")),d=i(s("../../libs/shared/dist/features/activity/components/Balances.js")),c=i(s("../../libs/shared/dist/features/activity/components/ExtLineItem.js")),l=i(s("../../libs/shared/dist/features/activity/components/Icon.js")),u=i(s("../../libs/shared/dist/features/activity/components/Text.js")),f=i(s("../../libs/shared/dist/features/activity/components/WebLineItem.js")),h={Avatar:o.default,AvatarDouble:r.default,Text:u.default,Icon:l.default,Address:n.default,ExtLineItem:c.default,Balances:d.default,WebLineItem:f.default};t.parse=function e(t,s={}){if("object"!=typeof t||!t)return t;if(Array.isArray(t))return t.map((t=>e(t)));if(void 0===t.type){const s={},i=Object.keys(t);for(const a of i)s[a]=e(t[a]);return s}if(Object.keys(h).includes(t.type)){const i=h[t.type],n=t.props,o={};for(const t of n)t.value&&"object"==typeof t.value?Array.isArray(t.value)?o[t.name]=t.value.map((t=>e(t))):o[t.name]=e(t.value):o[t.name]=t.value;return(0,a.jsx)(i,{...o,...s})}},t.default=h},"../../libs/shared/dist/features/activity/hooks/useActivityTransactions.js":(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useActivityTransactions=void 0;const i=s("../../../node_modules/react/index.js"),a=s("../../../node_modules/react-redux/es/index.js"),n=s("../../../node_modules/lodash/lodash.js"),o=s("../../libs/shared/dist/store/selectors/config.js"),r=s("../../libs/shared/dist/features/activity/api/index.js");t.useActivityTransactions=function({layout:e}){const t=(0,a.useSelector)(o.networkSelector),s=(0,a.useSelector)(o.walletSelector),[d,c]=(0,i.useState)(!0),[l,u]=(0,i.useState)(!1),[f,h]=(0,i.useState)([]),[m,p]=(0,i.useState)([]),[j,v]=(0,i.useState)([]),[y,_]=(0,i.useState)({}),b=(0,i.useRef)(j),g=(0,i.useRef)(y);(0,i.useEffect)((()=>{b.current=j}),[j]),(0,i.useEffect)((()=>{g.current=y}),[y]);const x=e=>{e&&(_((t=>({...t,...e.data.reduce(((e,s)=>({...e,[s.hash]:{...t[s.hash]??{},...s}})),{})}))),v((t=>"append"===e.position?[...t,...e.data]:[...e.data,...t])))};return{loadTransactions:async(i,a)=>{if(!i.length)return;const o=i[0].index,d=i[i.length-1].index,c=b.current.map((e=>e.hash)).slice(o,d+10);let l=(0,n.difference)(c,m);if(l=(0,n.difference)(l,f),l.length){h((e=>[...e,...l])),setTimeout((()=>{h((e=>(0,n.difference)(e,l)))}),1e3);for await(const i of(0,r.fetchTransactions)(s.instance?.publicKey,t.cluster,a,l,e))p((e=>[...e,...l])),_((e=>({...e,...i?.data?.reduce(((t,s)=>({...t,[s.hash]:{...e[s.hash]??{},...s}})),{})})))}},loadSignatures:async({publicKey:e,onlyNewer:s=!1,ignoreFailed:i,limit:a=0})=>{if(s||b.current.length){c(!1),u(!0);for await(const s of(0,r.fetchNewSignatures)(e,t.cluster,b.current[0]?.hash,i,a))x(s);u(!1)}else{c(!0),v([]),_({});for await(const s of(0,r.fetchSignatures)(e,t.cluster,i,a))x(s);c(!1)}},loadLimitTransactions:async i=>{const a=b.current.map((e=>e.hash));for await(const n of(0,r.fetchTransactions)(s.instance?.publicKey,t.cluster,i,a,e))_((e=>({...e,...n?.data?.reduce(((t,s)=>({...t,[s.hash]:{...e[s.hash]??{},...s}})),{})})))},signatures:j,transactions:y,isLoading:d,isPreloading:l}}},"../../libs/shared/dist/features/activity/index.js":function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebLineItem=t.ExtLineItem=t.useActivityTransactions=t.parse=void 0;const a=i(s("../../libs/shared/dist/features/activity/components/ExtLineItem.js"));t.ExtLineItem=a.default;const n=i(s("../../libs/shared/dist/features/activity/components/WebLineItem.js"));t.WebLineItem=n.default;var o=s("../../libs/shared/dist/features/activity/components/index.js");Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return o.parse}});var r=s("../../libs/shared/dist/features/activity/hooks/useActivityTransactions.js");Object.defineProperty(t,"useActivityTransactions",{enumerable:!0,get:function(){return r.useActivityTransactions}})},"../../libs/shared/dist/features/activity/selectors/index.js":(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.knownAddressSelector=void 0;const i=s("../../../node_modules/reselect/es/index.js"),a=s("../../libs/shared/dist/store/selectors/config.js"),n=s("../../libs/shared/dist/store/selectors/data.js");t.knownAddressSelector=(0,i.createSelector)([a.walletDataSelector,n.addressBookDataSelector],((e,t)=>{const s={};for(const t of e.accounts)s[t.publicKey]=t.name;for(const e of t)s[e.pubkey]=e.name;return s}))}}]);