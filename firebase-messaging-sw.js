"undefined"!=typeof chrome&&chrome.runtime?(importScripts("/firebase-app-8.10.0.min.js"),importScripts("/firebase-msg-8.10.0.min.js")):(importScripts("https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"),importScripts("https://www.gstatic.com/firebasejs/8.10.0/firebase-messaging.js"));const firebaseConfig={apiKey:"AIzaSyBnuytdyhVuSzo0qAhX5QWYu6Z2jTBPWog",authDomain:"solflare-d0638",projectId:"solflare-d0638",storageBucket:"solflare-d0638.appspot.com",messagingSenderId:"191112318129",appId:"1:191112318129:web:a3555b4ee54f13a6efa690"};firebase.initializeApp(firebaseConfig);const messaging=firebase.messaging();self.addEventListener("notificationclick",(async i=>{i.notification.close();const t=i.notification.data;i.waitUntil(self.clients.matchAll({type:"window",includeUncontrolled:!0}).then((i=>{let e=null,o=null;try{if(t&&t.customPayload){const i=t.customPayload.match(/^([A-Za-z]+):(.*)$/);i&&i.length>=3&&(o=JSON.parse(i[2]),e=i[1])}}catch(i){console.log(i)}const a=self.location.origin.includes("extension")?`${self.location.origin}/wallet.html#`:"";let n=`${a}/portfolio`,s=["source=notification"],c=null;if(t&&(c=t.key,c||(c=t.publicKey)),t&&o&&"CustomNotification"===e){const i=c?`/deeplink/${c}`:"";"dappBrowser"===o.redirect_page?(n=`${a}${i}/externallink`,s.push(`url=${encodeURIComponent(o.destination_url)}`)):"portfolioRoute"===o.redirect_page?n=`${a}${i}/portfolio`:"portfolioStakingRoute"===o.redirect_page?n=`${a}${i}/staking`:"tradingSwap"===o.redirect_page&&(n=`${a}${i}/trade`,o.destination_mint&&"So11111111111111111111111111111111111111112"!==o.destination_mint&&(s.push("from=So11111111111111111111111111111111111111112"),s.push(`to=${o.destination_mint}`))),o.campaign_id&&s.push(`campaign_id=${o.campaign_id}`),o.notification_id&&s.push(`notification_id=${o.notification_id}`)}else t&&c?(n=`${a}/deeplink/${c}/activity`,t.dappId&&(n=`${a}/deeplink/${c}/portfolio`,s.push(`msNotificationsCenter=${t.dappId}`))):t&&t.dappId&&(n=`${a}/portfolio`,s.push(`msNotificationsCenter=${t.dappId}`));return s?.length>0&&(n+=`?${s.join("&")}`),self.clients.openWindow(n)})))})),messaging.onBackgroundMessage((i=>{let t=null,e=null;if(i.data){let o="/assets/logo-128.png";i.data.icon&&(o=i.data.icon),["notification","broadcast","cast","event"].includes(i.data.type)&&(t=i.data.title,e={body:i.data.body,icon:o,data:i.data})}t&&e&&self.registration.showNotification(t,e)}));